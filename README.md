# Gauchian-enrich

This repository contains a command-line utility to annotate the `.tsv` file output from [Illumina/Gauchian](https://github.com/Illumina/Gauchian) tool.

## Setup

To use the `gauchian_enrich` utility, ensure Docker is installed on your system. Then, pull the Docker image:

```bash
docker pull ghcr.io/maurya-anand/gauchian-enrich
```

## Usage

**Step 1** : Run the [Illumina/Gauchian](https://github.com/Illumina/Gauchian) tool to obtain the `.tsv` and `.json` output.

**Step 2** : Use the `.tsv` ouput file from the previous step as an input to `gauchian_enrich` utility.

### Command-Line Options

- `--input` or `-i`: Specify the input `.tsv` file generated by the Gauchian tool.
- `--output` or `-o`: Specify the output file path. If omitted, a default output file will be created based on the input file name.
- `--help` or `-h`: Display usage instructions.
- `--version` or `-v`: Display the version of the `gauchian_enrich` tool.

>[!Note]
> The `gauchian_enrich` utility performs reverse annotation using the `transvar` tool and the `hg38` reference genome.
> The reverse annotation process relies on the `hg38` reference genome file (`/ref/hg38.fa`). The Docker image for `gauchian_enrich` comes preconfigured with the `hg38` reference genome, eliminating the need for users to download or configure the reference genome manually.

### Example usage

To display usage instructions:

```bash
docker run ghcr.io/maurya-anand/gauchian-enrich gauchian_enrich --help
```

To execute the tool using the given example data:

```bash
docker run -u $(id -u):$(id -g) -it \
    -v ${PWD}/test:/test \
    ghcr.io/maurya-anand/gauchian-enrich \
    gauchian_enrich -i /test/test.gauchian.tsv -o /test/test.gauchian.annotated.tsv
```

## Example data

### Input

| Sample           | is_biallelic(GBAP1-like_variant_exon9-11) | is_carrier(GBAP1-like_variant_exon9-11) | CN(GBA+GBAP1) | deletion_breakpoint_in_GBA | GBAP1-like_variant_exon9-11 | other_unphased_variants |
|-------------------|------------------------------------------|------------------------------------------|---------------|-----------------------------|-----------------------------|--------------------------|
| NA20815.final     | FALSE                                    | TRUE                                     | 4             | N/A                         | L483P/

### Output

| Sample         | is_biallelic(GBAP1-like_variant_exon9-11) | is_carrier(GBAP1-like_variant_exon9-11) | CN(GBA+GBAP1) | deletion_breakpoint_in_GBA | GBAP1-like_variant_exon9-11 | other_unphased_variants | input      | transcript                    | gene | strand | coordinates(gDNA/cDNA/protein)                          | region                   | info                                                                                                                                                                                                                                                                                                                      | CHROM | POS       | REF | ALT |
|----------------|--------------------------------------------|------------------------------------------|----------------|-----------------------------|------------------------------|--------------------------|------------|----------------------------------|------|--------|---------------------------------------------------------|--------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------|------------|-----|-----|
| NA20815.final  | FALSE                                      | TRUE                                     | 4              | N/A                         | L483P/                       | None                     | GBA:L483P | NM_001005742.2 (protein_coding) | GBA  | -      | chr1:g.155235252A>G/c.1448T>C/p.L483P                  | inside_[cds_in_exon_11] | CSQN=Missense;reference_codon=CTG;candidate_codons=CCT,CCG,CCA,CCC;candidate_mnv_variants=chr1:g.155235251_155235252delCAinsAG,chr1:g.155235251_155235252delCAinsTG,chr1:g.155235251_155235252delCAinsGG;dbxref=GeneID:2629,HGNC:HGNC:4177,MIM:606463;aliases=NP_001005742;source=RefSeq | chr1   | 155235252 | A   | G   |

## Reference

- Toffoli, M., Chen, X., Sedlazeck, F.J. et al. Comprehensive short and long read sequencing analysis for the Gaucher and Parkinson’s disease-associated GBA gene. Commun Biol 5, 670 (2022). [https://doi.org/10.1038/s42003-022-03610-7](https://doi.org/10.1038/s42003-022-03610-7)
- Zhou, W., Chen, T., Chong, Z. et al. TransVar: a multilevel variant annotator for precision genomics. Nat Methods 12, 1002–1003 (2015). [https://doi.org/10.1038/nmeth.3622](https://doi.org/10.1038/nmeth.3622)
